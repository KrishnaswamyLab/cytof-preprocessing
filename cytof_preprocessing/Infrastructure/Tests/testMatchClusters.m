addpath('../Source');

% Test 2: Statistic test.
rng(021088);
populationA = [normrnd(5  , 1, [100, 1]) normrnd(-7, 2  , [100, 1]) ; ...
               normrnd(6  , 1, [200, 1]) normrnd(-3, 1  , [200, 1]) ; ...
               normrnd(2.5, 2, [300, 1]) normrnd( 5, 0.5, [300, 1])];
populationB = [normrnd(5  , 1, [150, 1]) normrnd(-7, 2  , [150, 1]) ; ...
               normrnd(3  , 1, [150, 1]) normrnd(-3, 1  , [150, 1]) ; ...
               normrnd(6  , 1, [300, 1]) normrnd(-3, 1  , [300, 1]) ; ...
               normrnd(3.5, 3, [100, 1]) normrnd( 2, 0.5, [100, 1])];
clusterAssignmentA = [repmat(1, 100, 1) ; repmat(2, 200, 1) ; repmat(3, 300, 1)];
clusterAssignmentB = [repmat(1, 150, 1) ; repmat(2, 150, 1) ; repmat(3, 300, 1); repmat(4, 100, 1)];
assignment = matchClusters(populationA, populationB, clusterAssignmentA, clusterAssignmentB);
assert(isequal(assignment, [1 3 0]));
